<app-header></app-header>
<app-left-navigation></app-left-navigation>
<div fxLayout="row" fxlayoutAlign="space-between center" fxLayout.lt-sm="column" class="operationalHeading">
    <div fxLayout="row">
        <div fxFlex="">
            <h1>Zone Dashboard</h1>
        </div>
    </div>
    <div fxLayout="row">
        <div fxFlex="">
            <span>City</span>
        </div>
        <div fxFlex="">

            <mat-form-field appearance="fill">
                <mat-select (selectionChange)="cityChanged($event)" [(ngModel)]="selectedCity">
                    <mat-option *ngFor="let city of cityNames" [value]="city">
                        {{city}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>
    <div fxLayout="row">
        <div fxFlex="">
            <span>Plant</span>
        </div>
        <div fxFlex="">
            <mat-form-field *ngIf="plantNames" appearance="fill">
                <mat-select (selectionChange)="plantChanged($event)"
                    [(ngModel)]="selectedPlant">
                    <mat-option *ngFor="let plant of plantNames" [value]="plant">
                        {{plant}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>
    <div fxLayout="row">
        <div fxFlex="">
            <span> Site </span>
        </div>
        <div fxFlex="">
            <mat-form-field *ngIf="siteNames" appearance="fill">
                <mat-select (selectionChange)="siteChanged($event)" [(ngModel)]="selectedSite" class="form-contrl">
                    <mat-option *ngFor="let site of siteNames" [value]="site">
                        {{site}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>
</div>

<div fxLayout="row" fxlayoutAlign="space-around center" fxLayout.lt-sm="column" class="ZoneParaM">
    <div fxLayout="row">
        <div fxFlex="">
            <div fxFlex="100"><h5>Zone Parameters</h5></div>
            <div fxFlex=""><img src="assets/svg/info.svg" alt="info" /></div>
        </div>
    </div>
</div>



<div fxLayout="row" fxLayoutAlign="center center" fxLayout.lt-sm="column" class="zoneParaRow">
    <div fxLayout="row" class="zoneRow firstRow">
        <div fxlayout="row" class="zoneRight">
            <div fxlayout="row">
                <div fxFlex="">
                    <div fxFlex="12"><img src="assets/svg/Zone.svg" alt="zone" /></div>
                    <div fxFlex=""><h4>Zone : <span>1000</span></h4> </div>
                </div>
            </div>
            <div>
                <div style="height: 200px;" class="row">
                    <canvas baseChart [data]="demodoughnutChartData" [options]="chartOptions" [labels]="doughnutChartLabels"
                        [chartType]="doughnutChartType" [colors]="chartColors" (chartHover)="chartHovered($event)"
                        (chartClick)="chartClicked($event)">
                    </canvas>
                </div>
            </div>
        </div>

    <div fxlayout="row" class="zoneP">
        <div fxlayout="row">
            <div fxFlex="100">
              
                <div fxFlex=""><h4>Live Zones : 100</h4></div>
            </div>
            <div fxFlex="">
                <!-- <em>export</em> -->
                 <img src="assets/svg/download.svg" alt="download" />
            </div>
        </div>
        <div>
            <div style="height: 200px;" class="row">
                <canvas baseChart [data]="demodoughnutChartData" [options]="chartOptions" [labels]="doughnutChartLabels"
                    [chartType]="doughnutChartType" [colors]="chartColors" (chartHover)="chartHovered($event)"
                    (chartClick)="chartClicked($event)">
                </canvas>
            </div>
        </div>
    </div>
</div>

<div fxLayout="row" class="zoneRow">
         <div fxlayout="row" class="zoneRight">
        <div fxlayout="row">
            <div fxFlex="">
                <div fxFlex="12"><img src="assets/svg/emp.svg" alt="emp" /></div>
                <div fxFlex=""> <h4>Employees : 1000 </h4></div>
            </div>
        </div>
        <div>
            <div style="height: 200px;" class="row">
                <canvas baseChart [data]="demodoughnutChartData" [options]="chartOptions" [labels]="doughnutChartLabels"
                    [chartType]="doughnutChartType" [colors]="chartColors" (chartHover)="chartHovered($event)"
                    (chartClick)="chartClicked($event)">
                </canvas>
            </div>
        </div>
    </div>
    
    <div fxlayout="row" class="zoneP">
        <div fxlayout="row" >
            <div fxFlex="">
                <div fxFlex="100"> <h4>Active Employees : 100</h4></div>
                <div fxFlex="5" >
                    <!-- <em>export</em> -->
                    <img src="assets/svg/download.svg" alt="download" />
                </div>
            </div>
         
        </div>
        <div>
            <div style="height: 200px;" class="row">
                <canvas baseChart [data]="demodoughnutChartData" [options]="chartOptions" [labels]="doughnutChartLabels"
                    [chartType]="doughnutChartType" [colors]="chartColors" (chartHover)="chartHovered($event)"
                    (chartClick)="chartClicked($event)">
                </canvas>
            </div>
        </div>
    </div>
    </div>
</div>



<!--Data table starts-->
<div class="dataTabal opD">
    <div *ngIf="showZoneList" class="">
        <div class="dataTblHeadings">
            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayout.lt-sm="column">
                    <div fxFlex="10">
                        <button type="button" class="btn btn-info empList" (click)="showEmployees()">
                            Employee List
                        </button>
                    </div>
                    <div fxFlex="8">
                        <button type="button" class="btn btn-info empListNoBG" (click)="showZones()">Zone
                            List</button>
                    </div>
                    <div fxFlex="14" class="input-wrapper">
                        <div class="searchBtn">
                            <input type="text" class="form-control searchOp" [(ngModel)]="searchEmployeeId"
                            placeholder="Search by Zone Name" (keyup.enter)="onEmployeeIdEnter()">
                        </div>
                    </div>
                    <div fxFlex="33" class="zonesltAll">
                        <select  (selectionChange)="onZoneTypeChange($event)" [(ngModel)]="zoneType" class="form-controll">
                            <option *ngFor="let zone of zoneOptions" [value]="zone">
                                {{zone}}
                            </option>
                        </select>
                    </div>
                    <div fxFlex="98">
                        <div *ngIf="showZoneList && zones">
                                    <div class="row">
                                        <div class="zonePage" *ngIf="showPagination">
                                            <span *ngIf="enableFirstPager">
                                              <!-- <i style="cursor:pointer;" (click)="pagerClicked('first')"
                                                    class="fa fa-angle-double-left" aria-hidden="true">
                                                </i>  -->

                                            </span>
                                            <span *ngIf="!enableFirstPager">
                                                <i style="pointer-events:none;color: rgba(128, 128, 128, 0);"
                                                    class="fa fa-step-backward" aria-hidden="true">
                                                </i>
                                                </span>
                                            <span>
                                                <i *ngIf="enablePreviousPager" style="cursor:pointer;" (click)="pagerClicked('previous')"
                                                    class="ml-3 fa fa-caret-left" aria-hidden="true">
                                                </i>
                                            </span>
                                            <span><i *ngIf="!enablePreviousPager" style="pointer-events:none;color: grey;"
                                                    class="ml-3 fa fa-caret-left" aria-hidden="true"></i></span>
                                            <span *ngIf="showFirstPager"><button type="button"
                                                    [ngStyle]="{'background-color': selectedPageValue == firstPager? 'black': '#17a2b8'}"
                                                    class="ml-3 d-inline btn btn-info"
                                                    (click)="pagerNumClicked(firstPager, 1)">{{firstPager}}</button></span>
                                            <span *ngIf="showSecondPager"><button type="button"
                                                    [ngStyle]="{'background-color': selectedPageValue == secondPager? 'black': '#17a2b8'}"
                                                    class="ml-3 d-inline btn btn-info"
                                                    (click)="pagerNumClicked(secondPager, 2)">{{secondPager}}</button></span>
                                            <span *ngIf="showThirdPager"><button type="button"
                                                    [ngStyle]="{'background-color': selectedPageValue == thirdPager? 'black': '#17a2b8'}"
                                                    class="ml-3 d-inline btn btn-info"
                                                    (click)="pagerNumClicked(thirdPager, 3)">{{thirdPager}}</button></span>
                                            <span *ngIf="showFourthPager"><button type="button"
                                                    [ngStyle]="{'background-color': selectedPageValue == fourthPager? 'black': '#17a2b8'}"
                                                    class="ml-3 d-inline btn btn-info"
                                                    (click)="pagerNumClicked(fourthPager, 4)">{{fourthPager}}</button></span>
                                            <span *ngIf="showFifthPager"><button type="button"
                                                    [ngStyle]="{'background-color': selectedPageValue == fifthPager? 'black': '#17a2b8'}"
                                                    class="ml-3 d-inline btn btn-info"
                                                    (click)="pagerNumClicked(fifthPager, 5)">{{fifthPager}}</button></span>
                                            <span><i *ngIf="enableNextPager" style="cursor:pointer;" (click)="pagerClicked('next')"
                                                    class="ml-3 fa fa-caret-right" aria-hidden="true"></i></span>
                                            <span><i *ngIf="!enableNextPager" style="pointer-events:none;color: grey;"
                                                    class="ml-3 fa fa-caret-right" aria-hidden="true"></i></span>
                                            <span><i *ngIf="enableLastPager" style="cursor:pointer;" (click)="pagerClicked('last')"
                                                    class="ml-3 fa fa-step-forward" aria-hidden="true"></i></span>
                                            <span><i *ngIf="!enableLastPager" style="pointer-events:none;color: grey;"
                                                    class="ml-3 fa fa-step-forward" aria-hidden="true"></i></span>
                    
                                        </div>
                                    </div>
                                <div fxFlex="">
                                    <select class="form-control" [(ngModel)]="size" (change)="onSizeChange($event)">
                                        <option [value]="10">10</option>
                                        <option [value]="25">25</option>
                                        <option [value]="50">50</option>
                                        <option [value]="100">100</option>
                                    </select>
                                </div>

                                <div fxFlex="">
                                    <button type="button" class="ml-2 d-inline btn btn-info exportBtn"
                                (click)="exportZones()">Export</button>

                                </div>
                        </div>
                    </div>
                    <div fxFlex="">
                        <div *ngIf="showEmployeeList && employeeDeviceStatus">
                            <div class="">
                                <select class="form-control" [(ngModel)]="size" (change)="onSizeChange($event)">
                                    <option [value]="10">10</option>
                                    <option [value]="25">25</option>
                                    <option [value]="50">50</option>
                                    <option [value]="100">100</option>
                                </select>
                            </div>

                        </div>
                    </div>


            </div>
        </div>
        <!-- <div fxLayout="row" class="TblSubheading">
            <div fxFlex="">one</div>
        </div> -->

        <!-- <ag-grid-angular #agGrid style="width: 100%; height: 100%; flex-grow: 1; back" id="myGrid"
            class="ag-theme-alpine" [columnDefs]="columnDefs" [defaultColDef]="defaultColDef"
            (gridReady)="onGridReady($event)" [rowData]="employeeDashboardDto.employeestatus" >
        </ag-grid-angular> -->
        <table mat-table [dataSource]="dataSourceForZones" matSort (matSortChange)="sortData($event)"
        class="mat-elevation-z8">

        <!-- Name Column -->
        <ng-container matColumnDef="Zone Name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="zoneName">Zone Name </th>
            <td mat-cell *matCellDef="let element" style="cursor: pointer;
                                    color:#428bca!important" (click)="showEmployeesByZoneId(element.zoneId)">
                {{element.zoneName}} </td>
        </ng-container>
        <ng-container matColumnDef="Zone Threshold">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="zoneThreshold">Zone
                Threshold
            </th>
            <td mat-cell *matCellDef="let element">
                {{element.zoneThreshold}} </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="Employee Count">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="currentEmployeeCount">
                Employee Count </th>
            <td mat-cell *matCellDef="let element"> {{element.currentEmployeeCount}} </td>
        </ng-container>
        <ng-container matColumnDef="Hot Zone">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="isHotZone"> Hot Zone
            </th>
            <td mat-cell *matCellDef="let element"> {{element.isHotZone}} </td>
        </ng-container>
        <ng-container matColumnDef="Site Name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="siteName"> Site Name
            </th>
            <td mat-cell *matCellDef="let element"> {{element.site.siteName}} </td>
        </ng-container>
        <ng-container matColumnDef="Plant Name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="plantName"> Plant Name
            </th>
            <td mat-cell *matCellDef="let element"> {{element.plant.plantName}} </td>
        </ng-container>
        <ng-container matColumnDef="City Name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="cityName"> City Name
            </th>
            <td mat-cell *matCellDef="let element"> {{element.city.cityName}} </td>
        </ng-container>
        <ng-container matColumnDef="Started At">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="hotZoneStartedAt">
                Started At</th>
            <td mat-cell *matCellDef="let element"> {{element.hotZoneStartedAt}} </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumnsForZoneList"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsForZoneList;"></tr>
    </table>
    </div>
    <div *ngIf="showEmployeeList" class="">
        <div class="dataTblHeadings">
            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayout.lt-sm="column">
                    <div fxFlex="10">
                        <button type="button" class="btn btn-info empList" (click)="showEmployees()">
                            <span>Employee List</span>
                        </button>
                    </div>
                    <div fxFlex="8">
                        <button type="button" class="btn btn-info empListNoBG" (click)="showZones()">Zone
                            List</button>
                    </div>
                    <div fxFlex="14" class="input-wrapper">
                        <div class="searchBtn">
                            <input type="text" class="form-control searchOp" [(ngModel)]="searchEmployeeId"
                            placeholder="Search by employeeId" (keyup.enter)="onEmployeeIdEnter()">
                        </div>
                    </div>
                    <div fxFlex="38" class="">
                       
                    </div>
                
                <div fxFlex="">
                    <div class="ml-5" *ngIf="showPagination">
                        <span *ngIf="enableFirstPager"><i style="cursor:pointer;" (click)="pagerClicked('first')"
                                class="fa fa-step-backward" aria-hidden="true"></i></span>
                        <span *ngIf="!enableFirstPager"><i style="pointer-events:none;color: rgba(255, 255, 255, 0);"
                                class="fa fa-step-backward" aria-hidden="true"></i></span>
                        <span>
                            <i *ngIf="enablePreviousPager" style="cursor:pointer;" (click)="pagerClicked('previous')"
                                class="ml-3 fa fa-caret-left" aria-hidden="true">
                            </i></span>
                        <span><i *ngIf="!enablePreviousPager" style="pointer-events:none;color: grey;"
                                class="ml-3 fa fa-caret-left" aria-hidden="true"></i></span>
                        <span *ngIf="showFirstPager"><button type="button"
                                [ngStyle]="{'background-color': selectedPageValue == firstPager? 'black': '#17a2b8'}"
                                class="ml-3 d-inline btn btn-info"
                                (click)="pagerNumClicked(firstPager, 1)">{{firstPager}}</button></span>
                        <span *ngIf="showSecondPager"><button type="button"
                                [ngStyle]="{'background-color': selectedPageValue == secondPager? 'black': '#17a2b8'}"
                                class="ml-3 d-inline btn btn-info"
                                (click)="pagerNumClicked(secondPager, 2)">{{secondPager}}</button></span>
                        <span *ngIf="showThirdPager"><button type="button"
                                [ngStyle]="{'background-color': selectedPageValue == thirdPager? 'black': '#17a2b8'}"
                                class="ml-3 d-inline btn btn-info"
                                (click)="pagerNumClicked(thirdPager, 3)">{{thirdPager}}</button></span>
                        <span *ngIf="showFourthPager"><button type="button"
                                [ngStyle]="{'background-color': selectedPageValue == fourthPager? 'black': '#17a2b8'}"
                                class="ml-3 d-inline btn btn-info"
                                (click)="pagerNumClicked(fourthPager, 4)">{{fourthPager}}</button></span>
                        <span *ngIf="showFifthPager"><button type="button"
                                [ngStyle]="{'background-color': selectedPageValue == fifthPager? 'black': '#17a2b8'}"
                                class="ml-3 d-inline btn btn-info"
                                (click)="pagerNumClicked(fifthPager, 5)">{{fifthPager}}</button></span>
                        <span><i *ngIf="enableNextPager" style="cursor:pointer;" (click)="pagerClicked('next')"
                                class="ml-3 fa fa-caret-right" aria-hidden="true"></i></span>
                        <span><i *ngIf="!enableNextPager" style="pointer-events:none;color: grey;"
                                class="ml-3 fa fa-caret-right" aria-hidden="true"></i></span>
                        <span><i *ngIf="enableLastPager" style="cursor:pointer;" (click)="pagerClicked('last')"
                                class="ml-3 fa fa-step-forward" aria-hidden="true"></i></span>
                        <span><i *ngIf="!enableLastPager" style="pointer-events:none;color: grey;"
                                class="ml-3 fa fa-step-forward" aria-hidden="true"></i></span>

                    </div>
                </div>

                    <div fxFlex="">
                        <div *ngIf="showEmployeeList && employeeDeviceStatus">
                            <div class="">
                                <select class="form-control" [(ngModel)]="size" (change)="onSizeChange($event)">
                                    <option [value]="10">10</option>
                                    <option [value]="25">25</option>
                                    <option [value]="50">50</option>
                                    <option [value]="100">100</option>
                                </select>
                            </div>
                    </div>
                    </div>
                    <div fxFlex="">
                        <button type="button" class="ml-2 d-inline btn btn-info exportBtn"
                        (click)="exportEmployees()">Export</button>
                    </div>
                <!-- <div fxFlex="">
                    <div *ngIf="showEmployeeList && employeeDeviceStatus">
                            <div class="">
                                <select class="form-control" [(ngModel)]="size" (change)="onSizeChange($event)">
                                    <option [value]="10">10</option>
                                    <option [value]="25">25</option>
                                    <option [value]="50">50</option>
                                    <option [value]="100">100</option>
                                </select>
                            </div>


                            <button type="button" class="ml-2 d-inline btn btn-info exportBtn"
                            (click)="exportEmployees()">Export</button>
                    </div>
                </div> -->
          
            </div>
        </div>


        <div fxLayout="row" fxLayoutAlign="space-between center">
            <div fxFlex="">
                <table mat-table [dataSource]="dataSourceForEmployees" matSort (matSortChange)="sortData($event)"
                class="mat-elevation-z8">
    
                <!-- Name Column -->
                <ng-container matColumnDef="Employee Id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="employeeId">Employee Id </th>
                    <td mat-cell *matCellDef="let element">
                        {{element.employee.employeeId}} </td>
                </ng-container>
                <ng-container matColumnDef="Employee Name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="employeeName">Employee Name </th>
                    <td mat-cell *matCellDef="let element">
                        {{element.employee.name}} </td>
                </ng-container>
                <ng-container matColumnDef="Device Id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="deviceId">Device ID
                    </th>
                    <td mat-cell *matCellDef="let element">
                        {{element.device.deviceId}} </td>
                </ng-container>
    
                <!-- Weight Column -->
                <ng-container matColumnDef="Serial Number">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="serialNumber">
                        Serial Number</th>
                    <td mat-cell *matCellDef="let element"> {{element.serialNumber}} </td>
                </ng-container>
                <ng-container matColumnDef="Hot Zone">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="isHotZone"> Hot Zone
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.isHotZone}} </td>
                </ng-container>
                <ng-container matColumnDef="Zone">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="zone"> Zone
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.zone.zoneName}} </td>
                </ng-container>
                <ng-container matColumnDef="Site">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="siteName"> Site
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.site.siteName}} </td>
                </ng-container>
                <ng-container matColumnDef="Plant">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="plantName"> Plant
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.plant.plantName}} </td>
                </ng-container>
                <ng-container matColumnDef="City">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header="cityName"> City
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.city.cityName}} </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumnsForEmployeeList"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsForEmployeeList;"></tr>
            </table>
        </div>
        </div>
    </div>
